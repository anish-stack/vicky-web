(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9302],{12127:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/verifyotp",function(){return t(98269)}])},98269:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return j}});var n=t(85893),a=t(67294);t(53794);var r=t(11163);t(89516);var o=t(55066),l=t(16310),i=t(88748),c=t(79556),u=t(57785);t(61369);var m=t(44803),d=t(74865),h=t.n(d);t(70204);var g=e=>{let{buttonName:s,subTitle:t}=e,[d,g]=(0,a.useState)(!1),[x,p]=(0,a.useState)(""),b=(0,r.useRouter)(),[f,j]=(0,a.useState)(!1),[v,N]=(0,a.useState)(""),[_,y]=(0,a.useState)(60),[T,P]=(0,a.useState)(!0);(0,a.useEffect)(()=>{{let e=sessionStorage.getItem("phone_number");e?k.setFieldValue("phone_number",e):b.push("/login")}},[b]);let k=(0,o.TA)({initialValues:{name:"",phone_number:"",OTP:""},validationSchema:l.Ry({phone_number:l.Z_().required("Phone number is required").min(5,"Phone number must be at least 5 characters long").max(15,"Phone number cannot be more than 15 characters long"),OTP:l.Z_().required("OTP is required").matches(/^\d{4}$/,"OTP must be a 4-digit number")}),onSubmit:async e=>{try{h().start();let t=await (0,m.WL)(e);if(!0==t.status){var s;let e=null==t?void 0:null===(s=t.data)||void 0===s?void 0:s.token;e?(j(!0),N(null==t?void 0:t.message),localStorage.setItem("token",e),setTimeout(()=>{b.push("/booking")},3100)):console.error("Token not found in the response"),h().done()}else!1==t.status&&(g(!0),p(null==t?void 0:t.message),h().done())}catch(e){g(!0),p("Something Went Wrong!!"),h().done()}}}),S=async()=>{if(k.values.phone_number)try{let e=await (0,m.e$)({phone_number:k.values.phone_number});if(!0==e.status)try{j(!0),N("".concat(null==e?void 0:e.message)),y(60),P(!0)}catch(e){g(!0),p("Something Went Wrong!!")}else!1==e.status?(g(!0),p("".concat(null==e?void 0:e.message))):(g(!0),p("Something Went Wrong!!"))}catch(e){g(!0),p("Something Went Wrong!!")}};return(0,a.useEffect)(()=>{if(_>0){let e=setTimeout(()=>y(_-1),1e3);return()=>clearTimeout(e)}P(!1)},[_]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(i.Z,{className:"toast-container-custom",children:(0,n.jsxs)(c.Z,{onClose:()=>g(!1),show:d,delay:3e3,autohide:!0,className:"bg-danger text-white",children:[(0,n.jsxs)(c.Z.Header,{children:[(0,n.jsx)("strong",{className:"me-auto",children:"Message"}),(0,n.jsx)("small",{children:"Just now"})]}),(0,n.jsx)(c.Z.Body,{className:"text-start",children:x})]})}),(0,n.jsx)(i.Z,{className:"toast-container-custom",children:(0,n.jsxs)(c.Z,{onClose:()=>j(!1),show:f,delay:3e3,autohide:!0,className:"bg-success text-white",children:[(0,n.jsxs)(c.Z.Header,{children:[(0,n.jsx)("strong",{className:"me-auto",children:"Message"}),(0,n.jsx)("small",{children:"Just now"})]}),(0,n.jsx)(c.Z.Body,{className:"text-start",children:v})]})}),(0,n.jsxs)("div",{className:"banner-one-form signin-form mt-5",children:[(0,n.jsx)("h3",{className:"form-title mb-0",children:t}),(0,n.jsx)("form",{className:"form",onSubmit:k.handleSubmit,children:(0,n.jsx)("div",{className:"trip-options",children:(0,n.jsxs)("div",{className:"",children:[(0,n.jsxs)("div",{className:"mt-3 custom-input phone-input-custom position-relative",children:[(0,n.jsx)(u.ZP,{placeholder:"Enter WhatsApp Number",value:k.values.phone_number,defaultCountry:"IN",onChange:e=>{k.setFieldValue("phone_number",e)},onBlur:k.handleBlur,disabled:!0}),(0,n.jsx)("i",{className:"icon fa-regular fa-phone-volume position-absolute",style:{right:"30px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#666"}})]}),k.touched.phone_number&&k.errors.phone_number?(0,n.jsx)("p",{className:"text-danger text-start mb-0 error-message",children:k.errors.phone_number}):null,(0,n.jsxs)("div",{className:"mt-3 custom-input position-relative",children:[(0,n.jsx)("input",{type:"text",placeholder:"Enter OTP",name:"OTP",className:"custom-text-input",value:k.values.OTP,onChange:k.handleChange,onBlur:k.handleBlur}),(0,n.jsx)("i",{className:"icon fa-regular fa-lock position-absolute",style:{right:"30px",top:"50%",transform:"translateY(-50%)",pointerEvents:"none",color:"#666"}})]}),k.touched.OTP&&k.errors.OTP?(0,n.jsx)("p",{className:"text-danger text-start mb-0 error-message",children:k.errors.OTP}):null,(0,n.jsx)("p",{className:T?"text-muted mb-0 resend-otp":"text-primary custom-cursor-pointer mb-0 resend-otp",onClick:()=>{T||S()},children:T?"Resend OTP in ".concat(_,"s"):"Resend OTP"}),(0,n.jsx)("div",{className:"col-lg-12 col-md-12 col-sm-12 mt-3",children:(0,n.jsx)("button",{type:"submit",className:"taxisafar-theme-button w-100",disabled:k.isSubmitting,children:(0,n.jsx)("span",{className:"btn-title",children:k.isSubmitting?"Please Wait...":"Verify & Login"})})})]})})})]})]})},x=t(81786),p=t(28115),b=t(9008),f=t.n(b);function j(){let{isAuthenticated:e,checkAuth:s}=(0,p.Z)(),{customerDetail:t}=(0,x.j)(),o=(0,a.useRef)(!1),l=(0,r.useRouter)();return(0,a.useEffect)(()=>{o.current&&e&&(null==t?void 0:t.role)=="customer"?l.push("/booking"):o.current=!0},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f(),{children:(0,n.jsx)("title",{children:"Verify OTP"})}),(0,n.jsx)("section",{className:"vicky-cab-homebanner",children:(0,n.jsx)("div",{className:"page-header page-background d-flex justify-content-center align-items-center",style:{backgroundImage:"url(/images/banner/bg1.jpg)"},children:(0,n.jsx)("div",{className:"container text-center ",children:(0,n.jsx)("div",{className:"row d-flex items-align-center",children:(0,n.jsx)("div",{className:"col-xl-6 col-lg-6 col-md-12 col-sm-12 col-12 pb-5 vickycab-booking-form",children:(0,n.jsx)(g,{buttonName:"Verify OTP & Login",subTitle:"Check Your Booking Details"})})})})})})]})}},89516:function(){}},function(e){e.O(0,[658,6705,8154,6087,1697,2888,9774,179],function(){return e(e.s=12127)}),_N_E=e.O()}]);